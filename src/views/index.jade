extends nav

block content		
	if user
		h2= 'Logged in as '+ user.name
		h4 Add Post:
		form(action='/blog' method='post')
			label title: 
			input(name='title')
			br
			label body: 
			textarea(name='body' style='height:40px')
			br
			input(type='submit' value='add post')
		
		h4 All Posts
		each blogPost in blog
			p= 'ID: ' + blogPost.id
			p= 'Posted by ' + blogPost.username +' - ' + blogPost.title + ' - ' + blogPost.body
			each comment in blogPost.commentable
				p= comment.commentable
			p Add Comment:
			form(action='/comment' method='post')
				input(value='#{blogPost.id}' name='theid' hidden)  
				textarea(name='commentable' style='height:40px')
				br
				input(type='submit' value='add comment')

	else
		form(action='/login' method='post')
			label email
			input#email(name='email' required)
			br
			label password
			input#password(name='password' required)
			br
			input(type='submit' value='login' id='submit')
		a(href='/new') create new user
	h2#error-message= message

script(src='http://ajax.googleapis.com/ajax/libs/jquery/2.1.1/jquery.min.js')
	
	script.
		$(document).ready(function () {
			$('#submit').click(function(event) {
				if($('#email').val().trim().length === 0 || $('#password').val().trim().length === 0) {
					event.preventDefault();
					$('#error-message').html("Your username or password is empty.");
				}
			});
		});
